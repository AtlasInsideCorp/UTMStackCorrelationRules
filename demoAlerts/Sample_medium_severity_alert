# Rule version v1.0.0

- name: "Alert Sample Severity Medium"
  severity: "Medium"
  description: "This is an example of a medium-severity alert generated by UTMStack. 
                Its purpose is to illustrate how a real alert looks like and give you something to practice with during the tutorial."
  solution: "<ol>
    <li>Implement network-based filtering restrictions to prohibit data transfers to untrusted VPCs.</li>
    <li>Consider rotating access keys within a certain number of days to reduce the effectiveness of stolen credentials.</li>
    <li>Limit user account and IAM policies to the least privileges required. Consider using temporary credentials for accounts that are only valid for a certain period of time to reduce the effectiveness of compromised accounts.</li>
    </ol><br>
    <strong>Potential false positive: </strong> A new transport rule may be created by a system or network administrator. Verify that the configuration change was
    expected. Exceptions can be added to this rule to filter expected behavior."
  category: "Transfer Data to Cloud Account"
  tactic: "Exfiltration"
  reference: 
    - "https://docs.microsoft.com/en-us/exchange/security-and-compliance/mail-flow-rules/mail-flow-rules"
    - "https://attack.mitre.org/techniques/T1537/"
    - "https://attack.mitre.org/tactics/TA0010/"
  frequency: 360
  cache:
    - allOf:
        - field: "dataSource"
          operator: "=="
          value: "UTMStackExample"
        - field: "dataType"
          operator: "=="
          value: "example-data"
        - field: "logx.example_data.severity"
          operator: "=="
          value: "Medium"
      timeLapse: 360
      minCount: 1
      save:
        - field: "logx.example_data.src_user"
          alias: "SourceUser"
        - field: "logx.example_data.dest_user"
          alias: "DestinationUser"
        - field: "logx.example_data.src_host"
          alias: "SourceHost"
        - field: "logx.example_data.dest_host"
          alias: "DestinationHost"
        - field: "logx.example_data.src_port"
          alias: "SourcePort"
        - field: "logx.example_data.dest_port"
          alias: "DestinationPort"
