# Rule version v1.0.0

- name: "Alert Sample Severity High"
  severity: "High"
  description: "This is an example of a high-severity alert generated by UTMStack. 
                Its purpose is to illustrate how a real alert looks like and give you something to practice with during the tutorial."
  solution: "Set account lockout policies after a certain number of failed login attempts to prevent passwords from being guessed. 
            Too strict a policy may create a denial of service condition and render environments un-usable, with all accounts used in the brute force being locked-out.
            Use multi-factor authentication. Where possible, also enable multi-factor authentication on externally facing services.
            Refer to NIST guidelines when creating password policies."
  category: "Credential Access"
  tactic: "Brute Force: Password Guessing"
  reference: 
    - "https://attack.mitre.org/tactics/TA0006"
    - "https://attack.mitre.org/techniques/T1110/001/"
  frequency: 360
  cache:
    - allOf:
        - field: "dataSource"
          operator: "=="
          value: "UTMStackExample"
        - field: "dataType"
          operator: "=="
          value: "example-data"
        - field: "logx.example_data.severity"
          operator: "=="
          value: "High"
      timeLapse: 360
      minCount: 1
      save:
        - field: "logx.example_data.src_user"
          alias: "SourceUser"
        - field: "logx.example_data.dest_user"
          alias: "DestinationUser"
        - field: "logx.example_data.src_host"
          alias: "SourceHost"
        - field: "logx.example_data.dest_host"
          alias: "DestinationHost"
        - field: "logx.example_data.src_port"
          alias: "SourcePort"
        - field: "logx.example_data.dest_port"
          alias: "DestinationPort"
