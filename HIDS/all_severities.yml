- name: Medium level HIDS alert
  severity: Medium
  category: Medium level HIDS alert category
  frequency: 10
  cache:
    - allOf:
      - field: dataType
        operator: ==
        value: hids
      - field: logx.hids.severity_label
        operator: ==
        value: Medium
      - field: logx.hids.rule.description
        operator: not in
        value: "Listened ports status (netstat) changed (new port opened or closed).,Windows: User account changed.,Integrity checksum changed.,Windows Application error event,Host-based anomaly detection event (rootcheck).,User account changed,User account disabled or deleted,Exchange email with verdict: Phish,Interface entered in promiscuous(sniffing) mode.,Listened ports status (netstat) changed (new port opened or closed).,Integrity checksum changed."
      - field: logx.hids.rule.description
        operator: not contain
        value: benchmark
      - field: logx.hids.rule.description
        operator: not contain
        value: Benchmark
      timeLapse: 15
      minCount: 1
      save:
        - field: logx.hids.rule.description
          alias: AlertName
        - field: logx.hids.category
          alias: AlertCategory
        - field: logx.hids.agent.ip
          alias: DestinationIP
        - field: dataSource
          alias: DestinationHost

- name: High level HIDS alert
  severity: High
  category: High level HIDS alert category
  frequency: 10
  cache:
    - allOf:
      - field: dataType
        operator: ==
        value: hids
      - field: logx.hids.severity_label
        operator: ==
        value: High
      - field: logx.hids.rule.description
        operator: not in
        value: "Listened ports status (netstat) changed (new port opened or closed).,Windows: User account changed.,Integrity checksum changed.,Windows Application error event,Host-based anomaly detection event (rootcheck).,User account changed,User account disabled or deleted,Exchange email with verdict: Phish,Interface entered in promiscuous(sniffing) mode.,Listened ports status (netstat) changed (new port opened or closed).,Integrity checksum changed."
      - field: logx.hids.rule.description
        operator: not contain
        value: benchmark
      - field: logx.hids.rule.description
        operator: not contain
        value: Benchmark
      timeLapse: 15
      minCount: 1
      save:
        - field: logx.hids.rule.description
          alias: AlertName
        - field: logx.hids.category
          alias: AlertCategory
        - field: logx.hids.agent.ip
          alias: DestinationIP
        - field: dataSource
          alias: DestinationHost
