- name: "Special privileges assigned to new logon"
  severity: "Low"
  description: "The user account was granted the SeDebugPrivilege as part of a logon event. This indicates the user token generated on this machine may be targeted and abused by a malicious actor with system access"
  solution: "Limit permission so that users and user groups cannot create tokens. This setting should be defined for the local system account only. Administrators should log in as a standard user but run their tools with administrator privileges using the builtin accesss token manipulation command"
  category: "Access Token Manipulation"
  tactic: "Defence Evasion"
  reference: 
    - "https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4672"
  frequency: 60
  cache:
    - allOf:
        - field: "logx.wineventlog.event_id"
          operator: "=="
          value: 4672
        - field: "logx.wineventlog.event_data.PrivilegeList"
          operator: "contains"
          value: "SeDebugPrivilege"
        - field: "logx.wineventlog.event_data.SubjectUserSid"
          operator: "!="
          value: "S-1-5-18"
      timeLapse: 60
      minCount: 1
      save:
        - field: "logx.wineventlog.event_data.SubjectUserName"
          alias: "SourceUser"
        - field: "logx.wineventlog.host.name"
          alias: "SourceHost"
