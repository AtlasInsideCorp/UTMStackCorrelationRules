- name: "A user account was locked out"
  severity: "Low"
  description: "This event generates every time a user account is locked out"
  solution: "This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of system features. "
  category: "Permission Groups Discovery: Local Groups"
  tactic: "Discovery"
  reference: 
    - "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4740"
  frequency: 60
  cache:
    - allOf:
        - field: "logx.wineventlog.event_id"
          operator: "=="
          value: 4740
        - field: "logx.wineventlog.event_data.SubjectUserSid"
          operator: "!="
          value: "S-1-5-18"
      timeLapse: 60
      minCount: 1
      save:
        - field: "logx.wineventlog.event_data.SubjectUserName"
          alias: "SourceUser"
        - field: "logx.wineventlog.event_data.TargetUserName"
          alias: "DestinationUser"
        - field: "logx.wineventlog.host.name"
          alias: "SourceHost"