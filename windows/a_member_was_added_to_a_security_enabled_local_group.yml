- name: "A member was added to a security-enabled local group"
  severity: "Low"
  description: "This event generates every time a new member was added to a security-enabled (security) local group"
  solution: |
    "Audit local accounts permission levels routinely to look for situations thaht could allow an adversary to gain wide privileged account. These audits should check if new local accounts are created that have not be authorized. Imlementing LAPS mau help prevent reuse of local administrator credential across a domain."
  category: "Valid Accounts: Local Accunts"
  tactic: "Persistence"
  reference: 
    - "https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4732"
  frequency: 60
  cache:
    - allOf:
        - field: "logx.wineventlog.event_id"
          operator: "=="
          value: 4732
      timeLapse: 60
      minCount: 1
      save:
        - field: "logx.wineventlog.event_data.SubjectUserName"
          alias: "SourceUser"
        - field: "logx.wineventlog.event_data.TargetUserName"
          alias: "DestinationUser"
        - field: "logx.wineventlog.host.name"
          alias: "SourceHost"