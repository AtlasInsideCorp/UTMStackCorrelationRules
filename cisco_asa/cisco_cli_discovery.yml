- name: Cisco Discovery
  severity: Low
  description: Find information about network devices that is not stored in config files
  solution: This type of attack technique cannot be easily mitigated with preventive controls since it is based on the abuse of system features
  category: File and Directory Discovery
  tactic: Discovery
  reference: https://attack.mitre.org/tactics/TA0007
  frequency: 360
  cache: 
  - oneOff:
    - field: logx.wineventlog.message
      operator: "=="
      value:  "dir"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show processes"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show arp"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show version"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show ip route"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show ip interface"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show ip sockets"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show users"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show ssh"
    - field: logx.wineventlog.message
      operator: "=="
      value:  "show clock"
  timeLapse: 6000
  minCount: 2
  save: 
    - field: "logx.cisco_asa.clientIP"
      alias: SourceIP